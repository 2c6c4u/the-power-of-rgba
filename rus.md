# Возможности `rgba()`-функций в CSS

Одна из наиболее интересных для меня вещей в CSS — это новая [color-mod][1] [функция][2]. Она дает нам возможность манипулировать цветами прямо в браузере. Например, при наведении на кнопку мы можем изменить ее цвет без препроцессоров типа Sass так: `color: color(black darkness(50%));`.

Но пока поддержка цветовых CSS-функций не реализована, [временно][3] мы можем использовать PostCSS и компилировать их как обычные цвета. Или мы можем экспериментировать и исследовать силу CSS цветовых `rgba()`-функций, чтобы менять цвет на лету! Давайте помотрим, как это можно использовать.

## Как это работает ![basic idea][4]

В программах для дизайна, когда мы помещаем черный и белый блоки над большим синим блоком (как в примере), в результате мы получим соответственно более светлый или более темный синий цвет.

Это происходит потому, что при уменьшении непрозрачности, цвета будут смешиваться на основе того, белый это или черный. Знаете, что произойдет, если изменить синий фон на зеленый? Верно![Basic Idea Green][5]!
Как видите, при изменении цвета фона маленькие блоки стали выглядеть иначе: мы получили светлый и темный зеленый. Также мы можем изменить значение непрозрачности, чтобы выбрать более светлый или темный оттенок. Давайте отработаем этот базовый навык, чтобы перейти к реальным примерам.

## Применение концепции

Чтобы сохранить краткость примера выше, поиграем с непрозрачностью. В реальном дизайне нам может понадобиться альфа-значение `rgba()`.

````
	.header {
      background: rgba(0, 0, 0, 0.5); /* Черный с непрозрачностью 50% */
    }
````

Здесь мы взяли `background` вместо `opacity`, потому что при использовании `opacity` будут затронуты все потомки, а нам это не нужно. Если мы используем альфа-канал для свойства `background`, мы обеспечиваем изменение только нужного элемента.

Примечание: в демо мы будем использовать `rgba()`-функции Sass ради скорости. Например:

````
	.elem {
      background: rgba(white, 0.5);
    }
````
скомпилируется в:

````
	.elem {
      background: rgba(255, 255, 255, 0.5);
    }
````

### Оформление шапки сайта

Первый вариант использования `rgba()` — это темы для шапок веб-приложений. В [Trello][6] используются цвета фона с `rgba()` для дочерних элементов шапки (логотип, поле поиска, кнопки):

````
	.search {
      background: rgba(255, 255, 255, 0.5); /* Белый с 50% альфа-каналом */
    }
````
![Trello with Devtools][7]

Используя это, мы получаем возможность управлять темой шапки через изменение только ее фона, и дочерние элементы изменяются тоже.

В нашем примере мы можем сделать что-нибудь похожее на шапку Trello и поиграть с фоном через панель разработки

![Trello Header][8]

Обратите внимание, как отличается цвет фона потомков в двух шапках. Если мы хотим исследовать элемент и изменить фон родителя, мы можем настроить нашу шапку очень просто.

![Theming Header][9]
Посмотреть пример [Шапки][10] от Ahmad Shadeed ([@shadeed][11]) на [CodePen][12].

### Шапка статьи ![Article Header][13]

В этом примере использование `rgba()` будет полезно для:

* Рамки верхнего и нижнего краев
* Цвета фона отцентрованной обертки
* Цвета фона ссылок категории

![Article Header Annotated][14]

````
	.parent {
      background: #5aaf4c; /* фон родителя */
      box-shadow:
        inset 0 8px 0 0 rgba(255, 255, 255, 0.5),
        inset 0 -8px 0 0 rgba(255, 255, 255, 0.5); /* верхняя и нижняя рамки */
    }

    .contain {
      background: rgba(0, 0, 0, 0.1);
    }

    .category {
      background: rgba(255, 255, 255, 0.5);
    }
````
Посмотреть пример [Шапки Статьи][15] от Ahmad Shadeed ([@shadeed][11]) на
[CodePen][12].

### Кнопки

В темах для кнопок мы можем использовать `rgba()` для создания эффектов по наведению или фокусу через рамки и тени.

````
	.button {
      background: #026aa7;
      box-shadow: inset 0 -4px 0 0 rgba(0, 0, 0, 0.2);
    }

    .button:hover {
      box-shadow: inset 0 -4px 0 0 rgba(0, 0, 0, 0.6), 0 0 8px 0 rgba(0, 0, 0, 0.5);
    }

    .button:focus {
      box-shadow: inset 0 3px 5px 0 rgba(0, 0, 0, 0.2);
    }
````
Посмотреть пример [Кнопок][16] от Ahmad Shadeed ([@shadeed][11]) на [CodePen][12].

### Градиенты

Другой полезный прием — это заливка фона сплошным цветом и добавление псевдоэлемента с `rgba()`-цветами для точек перехода цветов градиента.

![Градиенты][17]

````
	.elem {
      background: green;
    }

    .elem:before {
      content: "";
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(to right, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.7));
    }
````

Это также дает нам возможность анимировать градиенты изменением одного только цвета фона.

````
	.elem {
      /* other styles */
      animation: bg 2s ease-out alternate infinite;
    }

    @keyframes bg
      to {
        background: green;
      }
    }
````
Посмотреть пример [Градиентов][18] от Ahmad Shadeed ([@shadeed][11]) на [CodePen][12].

### Вложенный элемент

Если у нас есть навигация списком в шапке, мы можем добавить цвет фона с `rgba()` для навигации. Это сделает фон немного прозрачным, поэтому он будет смешиваться с фоном родителя.

Посмотреть пример [Вложенных элементов][19] от Ahmad Shadeed ([@shadeed][11]) на [CodePen][12].

То же может использоваться для создания динамических эффектов при наведении:

Посмотреть пример [Эффектов при наведении][20] от Ahmad Shadeed ([@shadeed][11]) на [CodePen][12].

### Темные/светлые вариации цветовой схемы

Мы можем использовать эту идею для генерации различных оттенков определенной цветовой палитры через размещение псевдоэлемента над каждым цветным блоком с определенным значением `rgba()`.

Посмотреть пример [Цветовой палитры][21] от Ahmad Shadeed ([@shadeed][11]) на [CodePen][12].

### Эффекты изображения

Чтобы сделать изображение темнее или светлее, мы можем использовать псевдоэлемент с `rgba()`-фоном.

![][22]

При использовании цветного фона, мы можем создавать оттенки цвета. Кроме этого, мы можем использовать свойство `mix-blend-mode`, чтобы смешать фон с изображением для разных эффектов.

Важно проверить поддержку `mix-blend-mode` браузерами перед использованием:

````
	.elem:before {
      background: rgba(0, 0, 0, 1);
      mix-blend-mode: color;
    }
````

Если `mix-blend-mode` не поддерживается, изображение будет черным и пользователь не сможет его увидеть. Лучше использовать этот эффект как прогрессивное улучшение, но не полагаться на него. В этом может помочь `@support` или Modernizr.

````
 	@supports (mix-blend-mode: color) {
      /* здесь будут ваши расширенные стили */
    }
````
Посмотреть пример [Изображений][23] от Ahmad Shadeed ([@shadeed][11]) на [CodePen][12].

## Создание тем с CSS-переменными

Когда вы используете [CSS-переменные][24] (кастомные свойства) для родительских элементов, на изменение переменной также меняются все дочерние элементы. Например:

````
	:root {
      --brand-color: #026aa7;
    }

    /* Проверка поддержки CSS-переменных */
    @supports (--color: red) {
      .elem {
        background: var(--brand-color);
      }
    }

    var colors = ["#026aa7", "#5aaf4c", "#00bcd4", "#af4c4c"];
    var colorOptions = document.querySelectorAll(".option");
    var colorLabels = document.querySelectorAll(".option + label");

    for (var i = 0; i < colorOptions.length; i++) {

      /* Добавим слушателя события на каждую радио-кнопку */
      colorOptions[i].addEventListener('click', changeColor);

      /* Добавим значение каждой радио-кнопке из массива colors[] */
      colorOptions[i].value = colors[i];

      colorLabels[i].style.background = colors[i];
    }

    function changeColor(e) {
      /* Вызовем корневой элемент и установим значение определенного свойства. В нашем случае: --brand-color */
      document.documentElement.style.setProperty('--brand-color', e.target.value);
    }
````

Сочетая CSS-переменные и `rgba()`, мы можем делать раскладки и цвета более динамичными без переопределения нового цвета для каждого элемента.

Посмотреть пример [Шапки с CSS-переменными][25] от Ahmad Shadeed ([@shadeed][11]) на [CodePen][12].

## Что нужно принимать во внимание

### Запасной цвет

Хотя глобальная поддержка CSS-цветов [97.39%][26], важно обеспечить запасной вариант для не поддерживающих их браузеров.

````
	.elem {
      background: #fff;
      background: rgba(255, 255, 255, 0.5); /* браузеры без поддержки проигнорируют эту декларацию */
    }
````

### Проверка контрастности цвета

Мы должны обеспечивать контраст между элементами, соответствующий гайдлайнам. Иногда при использовании `rgba()` может получится цвет, который очень трудно читать. Вы можете использовать такие инструменты, как [Проверка контраста][27] от Lea Verou, чтобы определить, соответствуют ли цвета стандартам доступности.

 [1]: https://drafts.csswg.org/css-color/#modifying-colors
 [2]: https://github.com/postcss/postcss-color-function
 [3]: https://cloudfour.com/thinks/building-themes-with-css4-color-features/
 [4]: img/basic-idea-768x442.jpg%20768w
 [5]: img/basic-idea-green-768x442.jpg%20768w
 [6]: https://trello.com
 [7]: img/trello-768x211.jpg%20768w
 [8]: img/Screen-Shot-2016-10-22-at-6.38.58-AM-768x156.png%20768w
 [9]: img/theming-header.gif
 [10]: http://codepen.io/shadeed/pen/79bb883e8f17c41a90f46c8fdf1a40e2/
 [11]: http://codepen.io/shadeed
 [12]: http://codepen.io
 [13]: img/Screen-Shot-2016-10-22-at-6.56.33-AM-768x307.png%20768w
 [14]: img/article-header-768x306.jpg%20768w
 [15]: http://codepen.io/shadeed/pen/fc254c1f120cc38a1b199f96d1d07a85/
 [16]: http://codepen.io/shadeed/pen/f822dd1cac006c00d5418cddac19efac/
 [17]: img/gradients-768x490.jpg%20768w
 [18]: http://codepen.io/shadeed/pen/808cbbdee59ddffdd39c91c2f1a290f1/
 [19]: http://codepen.io/shadeed/pen/760a044dd7e6a7fed972ce3ee08dc02a/
 [20]: http://codepen.io/shadeed/pen/eb5a955b69c2e31b3dcc0e9131db21b2/
 [21]: http://codepen.io/shadeed/pen/c2a60d0ed9e0313a76cc2c24e05402c7/
 [22]: img/images-768x227.jpg%20768w
 [23]: http://codepen.io/shadeed/pen/759699e8fc8d5253540fd33880cafa81/
 [24]: https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables
 [25]: http://codepen.io/shadeed/pen/a78a3d28eee617784cc75e2fa3dfad76/
 [26]: http://caniuse.com/#search=rgba
 [27]: http://leaverou.github.io/contrast-ratio/
